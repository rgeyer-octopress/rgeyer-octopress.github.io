

<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Random Musings</title>
  <meta name="author" content="Ryan J. Geyer">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
    
  
  <meta name="description" content=" ">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.ryangeyer.com/page/17/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Random Musings" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="Random Musings" />
  <meta name="og:title" content="Random Musings" />
  <meta name="og:description" content=" " />
  <meta name="og:url" content="http://blog.ryangeyer.com/page/17/index.html"/>
  <meta name="url" content="http://blog.ryangeyer.com/page/17/index.html">
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2840005-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div id="front-wrapper">
  <div id="hero">
    <div id="hero-inner" class="container">
      <div class="span10 offset1">
  <h1>
    Random Musings
  </h1>
  <h2></h2>
</div>

    </div>
  </div>
  <section id="sub-hero">
    <div class="container">
      <div class="row">
  <div class="span4">
    <h2>about me</h2>
<p>Married 12 years to a loving and patient woman.</p>
<p>Father to 3 very energetic boys.</p>
<p>Addicted to cycling.</p>
<p>I do geeky stuff with machines, electronics, and computers.</p>

  </div>
  <div class="span6">
    
<h2>recent public projects</h2>
<dl id="gh_repos" class="" data-github-user="rgeyer" data-github-repo-count="5" data-github-skip-forks="true">
  <dd class="loading">Status updating&#8230;</dd>
</dl>
<script src="/javascripts/github.js" type="text/javascript"> </script>
<script src="/javascripts/libs/jXHR.js" type="text/javascript"> </script>


  </div>
  <div class="span2">
    <h2>found on</h2>

<a href="https://github.com/rgeyer/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>



<a href="http://stackoverflow.com/users/1305386/" rel="tooltip" title="Stack Overflow"><img class="social_icon" title="Stack Overflow" alt="stack overflow icon" src="/images/glyphicons_400_stack_overflow.png"></a>



<a href="http://www.linkedin.com/in/rjgeyer" rel="tooltip" title="Linkedin"><img class="social_icon" title="Linkedin" alt="Linkedin icon" src="/images/glyphicons_377_linked_in.png"></a>



<a href="http://twitter.com/rjgeyer" rel="tooltip" title="Twitter"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>











<a href="https://plus.google.com/+RyanGeyerCycles?rel=author" rel="tooltip" title="Google Plus"><img class="social_icon" title="Google Plus" alt="Google Plus icon" src="/images/glyphicons_386_google_plus.png"></a>



<a href="http://www.quora.com/Ryan-Geyer" rel="tooltip" title="Quora"><img class="social_icon" title="Quora" alt="Quora icon" src="/images/glyphicons_385_quora.png"></a>



<h2>contact at</h2>
<a href="mailto:me@ryangeyer.com">me@ryangeyer.com</a>


  </div>
</div>

    </div>
  </section>
  <div class="container">
    <div class="row" id="post-container">
    
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/07/29/58-magnitude-earthquake-in-chino-ca/">58 Magnitude Earthquake in Chino Ca</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-07-29T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/07/29/58-magnitude-earthquake-in-chino-ca/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-07-29 00:00:00 -0700</h2>

<p>layout: post
title: 5.8 Magnitude Earthquake in Chino, CA
comments: true
categories:
&ndash; News
tags:
&ndash; linkedin
status: publish
type: post
published: true
meta:
  <em>edit_last: &lsquo;1&rsquo;
  syntaxhighlighter_encoded: &lsquo;1&rsquo;
  </em>sexybookmarks_shortUrl: <a href="http://bit.ly/b3QXmd">http://bit.ly/b3QXmd</a>
  _sexybookmarks_permaHash: 5fb7ff5fd5f5bea3ab07d840a0e47361</p>

<h2>date: 2008-07-29 00:00:00 -0700</h2>

<p>Just felt <a href="http://quake.wr.usgs.gov/recenteqs/Quakes/ci14383980.html">this</a> earthquake here in Santa Barbara.</p>

<p>It was surprisingly long, and USGS is reporting that there were several aftershocks within a few minutes, all right around a 3 magnitude.</p>

<p>Certainly no damage or injuries here (that have been reported), and I just got word from someone in the &ldquo;City of Industry&rdquo; in LA who says everything is fine there as well.</p>

<p>Woo!</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/07/06/gap-fire-day-6/">Gap Fire Day 6</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-07-06T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/07/06/gap-fire-day-6/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-07-06 00:00:00 -0700</h2>

<p>layout: post
title: Gap Fire &ndash; Day 6
comments: true
categories:
&ndash; Gap Gire
tags:
&ndash; linkedin
status: publish
type: post
published: true
meta:
  <em>edit_last: &lsquo;1&rsquo;
  </em>sexybookmarks_shortUrl: <a href="http://bit.ly/b4OixJ">http://bit.ly/b4OixJ</a>
  _sexybookmarks_permaHash: d7ea102eefaa26442a3fa36d791fe473</p>

<h2>date: 2008-07-06 00:00:00 -0700</h2>

<p>Well, we visited the apartment yesterday afternoon, and found that the wind had reversed and the fire line had moved back nearly to the peak of the foothills behind our neighborhood.  Consequently, the smoke and ash too had receded and were being blow in the opposite direction.  In fact, it looked almost like a normal sunny afternoon!</p>

<p>Since we had packed a few things, and had laundry to do we went back to my mother-in-laws place, and wound up spending the night again.  However we&rsquo;re likely to be back in our apartment this afternoon/evening.</p>

<p>The fire is still just over 8,000 acres and is 24% contained.  Still a reasonable danger of it threatening Goleta, but at the moment it&rsquo;s a much bigger threat to the rural neighborhoods in the foothills.</p>

<p>So far so good!</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/07/05/gap-fire-day-5/">Gap Fire Day 5</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-07-05T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/07/05/gap-fire-day-5/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-07-05 00:00:00 -0700</h2>

<p>layout: post
title: Gap Fire &ndash; Day 5
comments: true
categories:
&ndash; Gap Gire
tags:
&ndash; linkedin
status: publish
type: post
published: true
meta:
  <em>edit_last: &lsquo;1&rsquo;
  </em>sexybookmarks_shortUrl: <a href="http://bit.ly/dwLkRm">http://bit.ly/dwLkRm</a>
  _sexybookmarks_permaHash: 213cfce2dee0ffceacb854ce000c9a17</p>

<h2>date: 2008-07-05 00:00:00 -0700</h2>

<p>As many of you may know, we live in Goleta California.  Over the past 5 days a wild fire has been raging in the foothills of Goleta.</p>

<p>The fire has burned over 8,000 acres and 20 structures as of this writing.  The fire is ~5-6 miles North by North West from our apartment at the moment, though there is no evacuation warning nor order for our neighborhood.  In fact, there is a Red Cross shelter setup on just the other side of the freeway from us at San Marcos High School.  There is an evacuation warning for the neighborhood just &frac12; mile north of our apartment.</p>

<p>We choose to grab some important things, and leave our apartment last night due to the air quality and power outages we were experiencing.  Power has been going off during the night for several hours at a time for the past 5 days since the fire started.  That combined with a requirement to keep all our doors and windows closed in order to keep the smoke and ash out caused out apartment to become unbearably hot.  We spent the night at my mother-in-laws place last night, and we&rsquo;ll likely be going back home this afternoon to see how the air quality etc. is.</p>

<p>At the moment, we&rsquo;re not particularly concerned that our home is at risk, but the ash/smoke and power outages is making it uncomfortable and at times impossible to stay home.  Our kingdom hall is only a few feet south of the road that is used as the demarcation line for the evacuation warnings, so our meetings and field service have been canceled for the holiday weekend.</p>

<p>Exciting times to be sure, but we&rsquo;re doing fine.  I&rsquo;ll try to keep everyone up to date by means of this blog.  You can also find regular updates about the fire stats on our <a href="http://www.keyt.com/news/local/22836584.html">local news website</a>.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/06/10/sweet-savory/">Sweet Savory</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-06-10T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/06/10/sweet-savory/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-06-10 00:00:00 -0700</h2>

<p>layout: post
title: Sweet ~= Savory
comments: true
categories:
&ndash; Funny
tags:
&ndash; linkedin
status: publish
type: post
published: true
meta:
  <em>sexybookmarks_shortUrl: <a href="http://bit.ly/9kTcoN">http://bit.ly/9kTcoN</a>
  </em>sexybookmarks_permaHash: 3f52b186d6d3022fe72aba826e9fada7</p>

<h2>date: 2008-06-10 00:00:00 -0700</h2>

<p>So my wife and I have this meal tonight.  It consists of one of those <a href="http://www.bertolli.us/classicdinners.aspx">Bertolli dinners in a bag</a>, a salad and some bread, accompanied by the recommended wine pairing (Chianti).</p>

<p>After completing it, we had some pastries made by <a href="http://entenmanns.gwbakeries.com/">Entenmanns</a>.  And no, we don&rsquo;t usually eat so much easily prepared food, we actually do know how to cook and my wife actually completed culinary school, we were just lazy tonight.</p>

<p>So as we&rsquo;re taking the last bites of our extraordinarily rich and sweet desserts my wife turns to me and says;</p>

<p>&ldquo;You know what would really finish this meal?&rdquo;</p>

<p>&ldquo;Coffee?!&rdquo; I say sarcastically since she teased me about not making some to go with dessert only moments ago.</p>

<p>&ldquo;No&rdquo;</p>

<p>&ldquo;Milk?&rdquo;</p>

<p>&ldquo;Close&rdquo; she says.</p>

<p>&ldquo;What?&rdquo; I ask&hellip;</p>

<p>&ldquo;Pickle&rdquo;</p>

<p>Let that sink in&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;</p>

<p>Clearly the perfect complement to our dessert will be a big salty and vinegary pickle!  Needless to say I laughed till I cried, then vowed to blog the incident for all to enjoy.</p>

<p>My wife insists that I clarify that she meant that the perfect compliment to the entire meal from start to finish would be a pickle.  I still find the combination hilarious.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/04/16/fedora-bash-history-meme/">Fedora Bash History Meme</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-04-16T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/04/16/fedora-bash-history-meme/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-04-16 00:00:00 -0700</h2>

<p>layout: post
title: Fedora Bash History Meme
comments: true
categories:
&ndash; Linux
tags:
&ndash; bash history
&ndash; fedora meme
&ndash; linkedin
status: publish
type: post
published: true
meta:
  <em>edit_last: &lsquo;1&rsquo;
  </em>sexybookmarks_shortUrl: <a href="http://bit.ly/9W6i5j">http://bit.ly/9W6i5j</a>
  _sexybookmarks_permaHash: 16adc2689b65c3738d57275c3fa14093</p>

<h2>date: 2008-04-16 00:00:00 -0700</h2>

<p>I just learned about a Bash History Meme originated at <a href="http://planet.fedoraproject.org/">Planet Fedora</a> from a <a href="http://basildoncoder.com/blog/">blog</a> I read regularly.</p>

<p>In short, you run the following command in bash, and show your results.</p>

<pre lang="bash">
history | awk '{a[$2]++ } END{for(i in a){print a[i] " " i}}'|sort -rn|head
</pre>


<p>My results from my home box are as follows;</p>

<pre lang="bash">
103 ls
59 cd
52 exit
38 vi
38 firefox
29 for
22 su
18 /opt/hdv/myworkflow.sh
14 ssh
13 diff
</pre>


<p>Seems I&rsquo;m unwilling to simply close my terminal window in KDE, but instead have to type &ldquo;exit&rdquo;.  The &ldquo;myworkflow.sh&rdquo; script is a work in progress which I hope to one day post about.  It does stuff to help me convert and do post production on video from my HDV camcorder.  I&rsquo;ve been using &ldquo;diff&rdquo; to compare original files with modified ones for web updates I&rsquo;ve been doing for clients.</p>

<p>Here&rsquo;s the results from my web hosting box;</p>

<pre lang="bash">
394 ls
212 cd
89 vi
77 exit
60 du
30 mv
28 rm
20 mkdir
19 pwd
12 cp
</pre>


<p>Suppose there&rsquo;s nothing particularly interesting here.  I was checking a file upload progress in a very nasty way by calling &ldquo;du&rdquo;, what can I say..  I&rsquo;m lazy.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/03/24/a-penny-for-your-soybean/">A Penny for Your Soybean</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-03-24T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/03/24/a-penny-for-your-soybean/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-03-24 00:00:00 -0700</h2>

<p>layout: post
title: A penny for your soybean?
comments: true
categories:
&ndash; Bio Diesel
tags:
&ndash; linkedin
status: publish
type: post
published: true
meta:
  <em>sexybookmarks_shortUrl: <a href="http://bit.ly/dcq6GI">http://bit.ly/dcq6GI</a>
  </em>sexybookmarks_permaHash: 2097302b3a77d739162cf0d823dc4134
  _edit_last: &lsquo;1&rsquo;</p>

<h2>date: 2008-03-24 00:00:00 -0700</h2>

<p><img src="http://farm6.static.flickr.com/5051/5449777902_4025f2b249_o.jpg" width="283" height="423" alt="soybeans" class="alignleft" /></p>

<p>If you know me, or if you&rsquo;ve read some of my blog posts you probably know I&rsquo;m a big fan of diesel engines.  In particular I&rsquo;m quite fond of biodiesel.  I&rsquo;ve often preached that while OPEC continues to shaft us on the price of crude oil making gasoline and petroleum based diesel unreasonably expensive, biodiesel should decrease in price as the process used to produce it becomes more advanced and cost effective.</p>

<p>So, you can imagine my dismay when I drove by the local station which sells B99 expecting to see that it&rsquo;s price continued to hover around $3.30 per gallon, only to see that it was well over $4 per gallon.  What gives?!  Biodiesel was supposed to be the stable and reliable alternative to petroleum diesel, and here it is trumping the price of petroleum diesel by several cents per gallon.</p>

<p>Well, I forgot one important point.  Biodiesel is not just about the process required to produce it, there is also the feedstock required for the raw vegetable oil.  Turns out, <a href="http://www.autobloggreen.com/2007/08/22/rising-soybean-prices-cramp-biodiesel-producers-style/">the price of soybean oil</a> has increased dramatically this season.  This in turn has made biodiesel prices mirror petroleum diesel prices.</p>

<p>Now, I suppose this should have been an easily foreseeable problem based on the rules of supply and demand, but somehow I&rsquo;m still disappointed.  This is leaving me with a lot of doubt over what had previously seemed like a rock solid and obvious conclusion of buying diesel vehicles or converting my existing ones to diesel.  Where I had thought I&rsquo;d want to buy an Excursion, I think the wife is going to get her way and we&rsquo;re going to get an Acura MDX.  And where I had thought I&rsquo;d like to convert my Ford Explorer to some sort of diesel power plant, I&rsquo;m seriously considering modding my existing motor.  I don&rsquo;t suppose I&rsquo;ll get the same kind of fuel economy, or performance in either case but at least I can predict that the price of my fuel will steadily rise until I&rsquo;d rather walk than drive, rather than being at the mercy of a new fuel and a new industry.</p>

<p>I&rsquo;m actually in no particular hurry to change anything, so I suppose I&rsquo;ll just wait to see how things pan out, and maybe I&rsquo;ll end up doing what I&rsquo;d initially planned.  But for now, consider me dejected and sad.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/03/13/microsofts-tlbimp-creates-leaky-bstr-signatures/">Microsofts Tlbimp Creates Leaky Bstr Signatures</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-03-13T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/03/13/microsofts-tlbimp-creates-leaky-bstr-signatures/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-03-13 00:00:00 -0700</h2>

<p>layout: post
title: Microsoft&rsquo;s Tlbimp creates leaky BSTR signatures
comments: true
categories:
&ndash; C# coding
tags:
&ndash; BSTR
&ndash; in/out
&ndash; linkedin
&ndash; memory leak
&ndash; tlbimp
status: publish
type: post
published: true
meta:
  <em>sexybookmarks_shortUrl: <a href="http://bit.ly/cchcxv">http://bit.ly/cchcxv</a>
  </em>sexybookmarks_permaHash: 4f51339ae6fbad1ee6d7194d8766bc7f</p>

<h2>date: 2008-03-13 00:00:00 -0700</h2>

<p>This one confounded me when I first discovered it, and I&rsquo;ve recently been reminded about it.  For the sake of remembering the details, and hopefully helping someone else out I&rsquo;m going to document it here.</p>

<p>The problem is this.  When you have a COM library that you need to use from a C# app, you import it as a reference.  In the background the Microsoft.NET wizards do their magic by running the <a href="http://msdn2.microsoft.com/en-us/library/tt0cf3sx(VS.80).aspx">Tlbimp.exe</a> to generate a managed DLL with all of the objects and interfaces from the COM library.  You proceed to use the code that Microsoft so conveniently converted for you fully confident that all is well.</p>

<p>But it&rsquo;s not.  See, suppose your COM library has a method that returns a <strong>BSTR</strong> via an [out] parameter, or perhaps it defines an interface for a listener your managed code must implement.  Suddenly there is the potential for a serious memory leak!</p>

<p>See, a <strong>BSTR</strong> in unmanaged code aren&rsquo;t just any normal string.  <strong>BSTR</strong>&rsquo;s are allocated by the system by calling <strong>SysAllocString</strong> and subsequently released by calling <strong>SysFreeString</strong>.  This poses a problem for managed code if you aren&rsquo;t careful.  Take the following listener interface for example.</p>

<p style="font-family: italic; font-size: 10px">*Interface names and GUID&#8217;s changed to protect the innocent</p>




<pre line="1" lang="idl">
interface IImplementMeListener : IDispatch{
[
id(0x000000C9)
]
HRESULT _stdcall notify([in] TEventType eventType, [in] BSTR data );
};</pre>


<p>The Tlbimp.exe generates a managed assembly with the following signature for this same method.</p>

<pre line="1" lang="csharp">
[ComImport, TypeLibType((short) 0x10c0), Guid("00000000-0000-0000-0000-000000000000")]
public interface IImplementMeListener
{
    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType=MethodCodeType.Runtime), DispId(0xc9)]
    void notify([In, ComAliasName("ExampleLib.TEventType")] TEventType eventType,
        [In, MarshalAs(UnmanagedType.BStr)] string data);
}</pre>


<p>Which means when you implement this interface in your managed class, you&rsquo;ll just have <strong>String</strong> as the data type for the second parameter.  Which might look like this.</p>

<pre line="1" lang="csharp">
class MyManagedListener : ExampleLib.IImplementMeListener{
    public void notify(ExampleLib.TEventType eventType, String data)
    {
        DoSomethingWithData(data);
    }
}</pre>


<p>So this is what happens.</p>

<p>1) Your COM library allocates the string to pass into your listener using <strong>SysAllocString</strong>.</p>

<p>2) Your COM library passes the newly allocated string into your managed app by calling the <strong>notify</strong> method of your listener.</p>

<p>3) Your managed app does whatever it&rsquo;s going to do with the string, then returns.</p>

<p>Normally in a fully managed app this would be no problem, when the reference count to the string finally reaches 0, the garbage collector sweeps it up and the memory is reclaimed.  However, in this case we have a problem.  The COM library allocated the string, and passed it into your managed app, and it&rsquo;s responsibility for that string ends there.  The expectation is that the client will release the <strong>BSTR</strong> by calling <strong>SysFreeString</strong>.  Clearly we can&rsquo;t explicitly do that to the managed <strong>String</strong> type.</p>

<p>So what do we do?  We rewrite the part of the assembly that Tlbimp.exe made for us, and adjust our listener implementation slightly.</p>

<p>This is how I did it, though there may be better ways.</p>

<p>1) Use a disassembler to view the code of the Tlbimp.exe generated assembly for your COM library.  I used, <a href="http://www.aisto.com/roeder/dotnet/">Lutz&rsquo;s Reflector</a>.</p>

<p>2) Copy the code for the entire library into a *.cs file, then change just the signature of the method you&rsquo;re concerned with.</p>

<p>The new signature should look like this.</p>

<pre line="1" lang="csharp">
[ComImport, Guid("00000000-0000-0000-0000-000000000000"), TypeLibType((short) 0x10c0)]
public interface IImplementMeListener
{
[MethodImpl(MethodImplOptions.InternalCall, MethodCodeType=MethodCodeType.Runtime), DispId(0xc9)]
    void notify([In, ComAliasName("ExampleLib.TEventType")] TEventType eventType,
        [In] IntPtr data);
}</pre>


<p>And your implementing class changes to this.</p>

<pre line="1" lang="csharp">
class MyManagedListener : ExampleLib.IImplementMeListener{
    public void notify(ExampleLib.TEventType eventType, IntPtr data)
    {
        String dataStr = Marshal.PtrToStringBSTR(data);
        DoSomethingWithData(dataStr);
        Marshal.FreeBSTR(data);
    }
}</pre>


<p>This is not particularly tricky wizardry.  All we&rsquo;re doing is marshaling the input value from the library as an <strong>IntPtr</strong> instead of a managed <strong>String</strong>.  This allows us to explicitly release it using the <strong>System.Runtime.InteropServices.Marshal.FreeBSTR</strong> method, just like the library expects us to do.</p>

<p>Hopefully, this will save you some hastle, and avoid a potentially large memory leak.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/03/11/check-out-my-new-ride/">Check Out My New Ride</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-03-11T00:00:00-07:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/03/11/check-out-my-new-ride/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-03-11 00:00:00 -0700</h2>

<p>layout: post
title: Check out my new ride!
comments: true
categories:
&ndash; Rants
&ndash; Supercars
tags:
&ndash; discount
&ndash; enthusiast
&ndash; linkedin
&ndash; supercar
status: publish
type: post
published: true
meta:
  <em>edit_last: &lsquo;1&rsquo;
  </em>sexybookmarks_shortUrl: <a href="http://bit.ly/aT6pNZ">http://bit.ly/aT6pNZ</a>
  _sexybookmarks_permaHash: 4ad0344a9dc019bfb1c17ed292fad8e5</p>

<h2>date: 2008-03-11 00:00:00 -0700</h2>

<p><img src="http://farm6.static.flickr.com/5016/5449168507_97423bc6a9_o.jpg" width="436" height="275" alt="fordgt" /></p>

<p>No, I didn&rsquo;t actually buy a super car, but I think that I should be able to.  Allow me to elaborate.</p>

<p>I live in a rather affluent part of Southern California and nice (expensive) cars are not uncommon on our roads.  I spent just a couple hours recently at Shoreline (some bluffs just over the beach) and watched as every 3rd car that drove by was a Porshe.  Mostly boxters and cayman but none the less, where else in this world are porche&rsquo;s more common than hondas?  Here, you have to drive a Ferrari or Lamborghini to even begin to stand out.</p>

<p>It&rsquo;s worse than that though.  I know of no less than 3 Ford GT&rsquo;s, 2 BMW M5&rsquo;s, 4-5 Astin Martin Vanquish, 2-3 Ferrari F430&rsquo;s, countless Bently GT&rsquo;s and Mercedes AMG&rsquo;s of all flavor, and last but not least one Maserati quattroporte which I see every day at work.  If I recall, when I read a magazine review of the Maserati the author felt comfortable saying that you may never see one of these vehicles in person, and here I am fighting for a parking spot with one.</p>

<p>Now those are just the cars that I&rsquo;ve observed on the road, god knows what is tucked away in garages and not driven but on the most holy of days to tootle on down to the country club.  And here, by my reckoning, is the worst part.  Most of the owners of the cars have NO CLUE how to drive, nor will they ever come close to exercising those cars to any where near the potential.  The worst offenders are the trophy wives who are driving around in their various Mercedes Benz AMG&rsquo;s.  There isn&rsquo;t one of them that drives more than 40 MPH at any time for any reason, very much including the freeway.  Either that, or they think they&rsquo;re an Andretti and drive dangerously fast in a straight line, and panic whenever they have to actually change trajectory.  Why their sugar daddies thought it was necessary to spend 30% more for the same car, but with a ton more power they&rsquo;ll never use, I can only guess.</p>

<p>Which brings me to the point of my rant.  I know, about time eh?!  I think that all manufacturers that make cars built for the enthusiast should have some sort of discount program.  Here&rsquo;s how it would work.</p>

<p>Perhaps only a couple weeks out of each year, you could walk in to your favorite uber car dealership, take a test drive, and chat with the salesperson.  Then before you go to sign the paperwork for your shiny new cruise missile you are required to prove your enthusiasm for the car.  How you ask?  By proving your mettle on a series of driving tests.</p>

<p>Picture this, you get behind the wheel of the $360k car that you&rsquo;d like to buy, and if you can wring it around the test track in less time than a certain predefined speed, demonstrate competence in controlling the car at, and beyond the limits of traction, and otherwise convince the manufacturer that you&rsquo;re willing and able to drive the car in the way it was designed, why it&rsquo;s yours for a mere fraction of the price!</p>

<p>Isn&rsquo;t that what it&rsquo;s really about anyway?  These cars aren&rsquo;t built so that only real estate moguls and CEO&rsquo;s can own and drive them.  No!  They&rsquo;re designed to be driven FAST, on a track by a talented and appreciative driver.  So why not give your average Joe the ability to get into one of these vehicles, someone who would really cherish the privilege and (hopefully) have some respect for traffic laws and be able to control the vehicle on the street, someone like ME!</p>

<p>It might even cut down on the number of <a href="/2008/03/05/with-great-power-comes/">incompetent and unexperienced</a> drivers that get behind the wheel of these monsters.</p>

<p>Just a thought.  Manufacturers are you listening?  I&rsquo;ll take delivery of my Ford GT as soon as you realize how good this would be for business.  ;&ndash;)</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/03/06/tools-for-updating-an-online-image-gallery/">Tools for Updating an Online Image Gallery</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-03-06T00:00:00-08:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/03/06/tools-for-updating-an-online-image-gallery/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-03-06 00:00:00 -0700</h2>

<p>layout: post
title: Tools for updating an online image gallery
comments: true
categories:
&ndash; Linux
tags:
&ndash; automation
&ndash; bash
&ndash; linkedin
&ndash; Linux
&ndash; website management
status: publish
type: post
published: true
meta:
  <em>edit_last: &lsquo;1&rsquo;
  </em>sexybookmarks_shortUrl: <a href="http://bit.ly/cjCBgT">http://bit.ly/cjCBgT</a>
  _sexybookmarks_permaHash: bb1e4109f05eed571f8ca5f49850a606</p>

<h2>date: 2008-03-06 00:00:00 -0700</h2>

<p>Not long ago I shared my bash script for <a href="/2008/02/20/image-thumbnail-generating-script/">creating thumbnails</a> and manageable sized &ldquo;big&rdquo; images for an image gallery, or other image store.  Well, today I had to update an existing gallery with a pretty significant number of new images.  It occurred to me that I&rsquo;d like to only convert new images rather than re-converting the whole lot.  Then, I&rsquo;d like to simply upload the new files to my server in some automated way.</p>

<p>So here&rsquo;s the tools to do it.  It assumes you have the same layout for your pictures on your local drive as I do, which is as follows.</p>

<ul>
    <li><strong><em>RootDirectoryForGallery</em></strong> &#8211; This contains the full resolution pictures directly from your camera, and the following directories.
<ul>
    <li><strong><em>web</em></strong> &#8211; This is a sub directory of RootDirectoryForGallery which contains the &#8220;big&#8221; web version of your image, and the thumbnails directory described below.
<ul>
    <li><strong><em>thumbnails</em></strong> &#8211; This is a sub directory of web, and contains the thumbnail sized versions of the images.</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>The first step, is to copy your new pictures from the digital camera to your <strong><em>RootDirectoryForGallery</em></strong>.  Then, we want to get a list of the files that are new, so we run the following from the <strong><em>RootDirectoryForGallery</em></strong>.</p>

<pre lang="bash">
diff . web/ | grep 'Only in \.: d' | awk '{print $4}' | grep jpg &gt;&gt; 3-6-08_update.diff</pre>


<p>This creates a file in the <strong><em>RootDirectoryForGallery</em></strong> named &ldquo;3-6-08_update.diff&rdquo; which contains a list of only the new pictures, one per line.  Now, we want to use our image thumbnail script to convert only the new images to the &ldquo;big&rdquo; and thumbnail sized images.  I discovered that I needed to make a change to my script in order to do this.  Namely in the for loop I needed to enclose the command used to list files in &ldquo;$()&rdquo;.  The modified script is shown below.  Notice the &ldquo;$($SEARCH)&rdquo; where there was previously just &ldquo;$SEARCH&rdquo;.</p>

<pre lang="bash">
#!/bin/bash

SEARCH=$1
SIZE=$2
DEST=$3

if [ $# -lt 3 ]
then
echo "You must pass three arguments 1) The search string (usually *.jpg) 2) The destination size I.E. 500x374 3) The destination directory"
exit 1
fi

for i in $($SEARCH)
do
        echo "Converting $i"
        convert -resize $SIZE $i -resize $SIZE +profile '*' $DEST$i
done</pre>


<p>So with our edited script we convert the files.</p>

<pre lang="bash">
/opt/imagethumbnail.sh "cat 3-6-08_update.diff" "800x600" "web/"
/opt/imagethumbnail.sh "cat 3-6-08_update.diff" "150×112 "web/_thb_"</pre>


<p>Lastly, we want to upload just the changed files to our server.  We&rsquo;ll use rsync for this.  The paths, server name, and user name have been changed to protect the innocent.  ;&ndash;)</p>

<pre lang="bash">
rsync -e ssh -av /path/to/local/copy/ yourusername@yourserver.com:/path/to/www/server/copy/</pre>


<p>And there you have it, with just a few simple commands you&rsquo;ve created thumbnails of all of your images, and uploaded just the new ones to your server.  Easy!</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/2008/03/05/with-great-power-comes/">With Great Power Comes</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/+RyanGeyerCycles?rel=author"><span class="fn">Ryan J. Geyer</span></a></span>
  

 - 
        








  


<time datetime="2008-03-05T00:00:00-08:00" pubdate data-updated="true"></time> - 
        


        
         | <a href="/2008/03/05/with-great-power-comes/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>date: 2008-03-05 00:00:00 -0700</h2>

<p>layout: post
title: With great power comes?
comments: true
categories:
&ndash; Rants
tags:
&ndash; horsepower
&ndash; linkedin
&ndash; performance
status: publish
type: post
published: true
meta:
  <em>sexybookmarks_shortUrl: <a href="http://bit.ly/cn87eM">http://bit.ly/cn87eM</a>
  </em>sexybookmarks_permaHash: 62968fcfad5dbf0183fb83f236b636ef
  _edit_last: &lsquo;1&rsquo;</p>

<h2>date: 2008-03-05 00:00:00 -0700</h2>

<p>I&rsquo;ve been noticing a trend lately in modern cars.  Everything is getting exponentially faster and more powerful, and meanwhile more affordable.</p>

<p>You can go out today and buy a lightweight SUV or sedan from Jeep/Dodge/Chrystler with a 420hp Hemi for around $35k.  But it&rsquo;s not just the &ldquo;hot rod&rdquo; cars that are getting big power, a 2008 Honda Civic has no less than 140hp in it&rsquo;s cheapest form.  Not even 10 years ago that amount of power was reserved for the &ldquo;Si&rdquo; model.  A 2008 Honda Accord v6 has 286hp.  The performance of these cars easily exceeds that of the 60&rsquo;s and 70&rsquo;s muscle car and is well in excess of what most drivers need, or can use.</p>

<p>Meanwhile, all you need to do is memorize a few rules and convince a government worker that you can drive in a straight line and use your signals when appropriate to get a license.  Worse still, you only need to prove it once.  Afterward you&rsquo;ll just get a renewal notice in the mail until your 130th birthday when they start to wonder if you are still alive, and should be driving.  That&rsquo;s well past the age where &ldquo;oops I mistook the gas for the brake&rdquo; is at an acceptable margin of error.  There is no requirement to handle power induced slides, know how to react when you start to go sideways in a turn, nothing!  But 16 year old Johnny, if he&rsquo;s fortunate, or wealthy can be behind the wheel of a relative super car.</p>

<p>Where&rsquo;s the responsibility?  You should have some vague inclination of how to drive, and control yourself if you&rsquo;re going to be able to drive some of todays cars on the street with others.  Now don&rsquo;t get me wrong, my first car was a 1967 Thunderbird which made 340hp.  However, it almost NEVER ran well enough to generate that power and deliver it to the tires.  Furthermore, I had to work hard on that car to even keep it running, which gave me a good sense of it&rsquo;s inner workings, and exactly what I was dealing with.  I was also taught a few important lessons about speed and control before I was set out on my own with it or any other vehicle.</p>

<p>The idea of just anyone with an (easily acquired) drivers license behind the wheel of some of these vehicles is frankly quite terrifying to me, particularly in the face of the sort of antics I see on a daily basis even from &ldquo;mature&rdquo; drivers.  Mind you I wasn&rsquo;t alive during the &ldquo;hot rod&rdquo; era of the 60&rsquo;s and 70&rsquo;s where I&rsquo;m sure a similar situation existed, even in the absence of anti lock disk brake systems, air bags, and chassis/traction controls, so maybe this is just history repeating itself.</p>
</div>
  
  


</div>

      </article>
    
    </div>
      <div class="row">
        <ul class="pager">
          
            <li class="previous">
              <a href="/page/18/">&larr; Older</a>
            </li>
          
          
            <li class="next">
              <a class="next" href="/page/16/">Newer &rarr;</a>
            </li>
          
        </ul>
      </div>
  </div>
</div>


  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">
      
        <li>
          <a href="/2014/04/13/out-of-hibernation/">Out of hibernation?</a>
        </li>
      
        <li>
          <a href="/2011/12/28/anatomy-of-an-iaas-cloud/">Anatomy Of An Iaas Cloud</a>
        </li>
      
        <li>
          <a href="/2011/12/19/the-truth-about-set-top-boxes-no-one-wants-you-to-know/">The Truth About Set Top Boxes No One Wants You To Know</a>
        </li>
      
        <li>
          <a href="/2011/11/03/i-m-becoming-one-of-this-moms-and-it-scares-me/">I M Becoming One Of This Moms And It Scares Me</a>
        </li>
      
        <li>
          <a href="/2011/10/30/one-month-one-awesome-month-/">One Month One Awesome Month</a>
        </li>
      
    </ul>
    <h2><a href="/blog/archives">archives</a></h2>
  </div>
  <div class="span3">
    <h2>social stuff</h2>
<center>
  <script type="text/javascript" src="http://twittercounter.com/embed/?username=rjgeyer&style=avatar"></script><noscript><a href="http://twittercounter.com/rjgeyer">Ryan Geyer on Twitter Counter.com</a></noscript>

  <iframe src="http://widgets.klout.com/badge/rjgeyer?size=m" style="border:0" scrolling="no" allowTransparency="true" frameBorder="0" width="160px" height="78px"></iframe>

  <a href="http://www.linkedin.com/pub/1/828/328" ><img src="http://www.linkedin.com/img/webpromo/btn_viewmy_120x33.gif" width="120" height="33" border="0" alt="View Ryan Geyer's profile on LinkedIn"></a>
</center>

  </div>
  <div class="span4">
    
<a class="twitter-timeline" href="https://twitter.com/rjgeyer" data-widget-id="436931274691706882">Tweets by @rjgeyer</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>


  </div>
  <div class="span2">
    <h2>found on</h2>

<a href="https://github.com/rgeyer/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>



<a href="http://stackoverflow.com/users/1305386/" rel="tooltip" title="Stack Overflow"><img class="social_icon" title="Stack Overflow" alt="stack overflow icon" src="/images/glyphicons_400_stack_overflow.png"></a>



<a href="http://www.linkedin.com/in/rjgeyer" rel="tooltip" title="Linkedin"><img class="social_icon" title="Linkedin" alt="Linkedin icon" src="/images/glyphicons_377_linked_in.png"></a>



<a href="http://twitter.com/rjgeyer" rel="tooltip" title="Twitter"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>











<a href="https://plus.google.com/+RyanGeyerCycles?rel=author" rel="tooltip" title="Google Plus"><img class="social_icon" title="Google Plus" alt="Google Plus icon" src="/images/glyphicons_386_google_plus.png"></a>



<a href="http://www.quora.com/Ryan-Geyer" rel="tooltip" title="Quora"><img class="social_icon" title="Quora" alt="Quora icon" src="/images/glyphicons_385_quora.png"></a>



<h2>contact at</h2>
<a href="mailto:me@ryangeyer.com">me@ryangeyer.com</a>


  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  <a href="/">Random Musings</a>
  - Copyright &copy; 2014 - Ryan J. Geyer
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
  
    <span>Designed by <a href="http://www.AdrianArtiles.com">Adrian Artiles</a>.</span>
  
</p>

  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>


<script type="text/javascript">
      var disqus_shortname = 'randmu';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
